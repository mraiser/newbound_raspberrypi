{"data":{"css":".gpio-output {\n  width: 100%;\n  height: 100%;\n  max-width: 480px;\n  max-height: 480px;\n}","data":[],"name":"gpiooutput","js":"var me = this;\nvar ME = $('#'+me.UUID)[0];\n\nvar el = $(ME).find('.gpio-output')[0];\nvar data = me.data = $(ME).data('control');\n\nvar prefix = !data.peer ? (typeof CURRENTDEVICEPREFIX != 'undefined' ? CURRENTDEVICEPREFIX : '../') : (data.peer == 'local' ? '../' : '../peerbot/remote/'+data.peer+'/')\n\nme.ready = function(){\n  if (!data.pin) data.pin = 0;\n  if (!data.title) data.title = 'GPIO '+data.pin;\n  data.value = -1;\n  data.click = function(x){\n    if (data.value != -1){\n      data.value = 1 - data.value;\n      console.log(data.value);\n      el.api.redraw();\n      json(prefix+'raspberrypi/gpio', 'pin='+data.pin+'&output=true&value='+data.value, function(result){\n        el.api.update(parseInt(result.msg));\n      });\n    }\n  };\n  \n  installControl(el, 'raspberrypi', 'powerbutton', function(result){\n    me.refresh();\n  }, data);\n};\n\nme.refresh = function(){\n  if ($(document.body).find(el)[0] == el) json(prefix+'raspberrypi/gpio', 'pin='+data.pin+'&output=true&value=-1', function(result){\n    el.api.update(parseInt(result.msg));\n    setTimeout(me.refresh,3000);\n  });\n};\n","groups":"trusted","ctl":"nyqywl175ae859180j3ec","html":"<div class='gpio-output' />","three":{"controls":[]},"db":"raspberrypi","desc":""},"readers":["trusted"],"id":"nyqywl175ae859180j3ec","time":1605017667728,"addr":"/0:0:0:0:0:0:0:1:40780","username":"admin"}